<h1>Cart</h1>

<div class="pull-right">
  <%= link_to("清空购物车", cart_clean_cart_path(current_cart), method: :delete, data: { confirm: "你确定要清空整个购物车吗？" }, :class => "btn btn-warning", :style => "margin: 0px 0px 10px 0px")%>
</div>



<table class="table table-hover">
  <tr>
    <th>Title</th>
    <th>Image</th>
    <th>Price</th>
    <th>Quantity</th>
    <th>Action</th>
  </tr>
  <% @cart.cart_items.each do |cart_item| %>
  <tr>

    <td>
      <%= link_to product_path(cart_item.product) do %>
        <%= cart_item.product.title %>
      <% end %>
    </td>
    <td>
      <%= link_to product_path(cart_item.product) do %>
        <% if cart_item.product.image.present? %>
          <%= image_tag(cart_item.product.image.thumb.url, :class => "thumbnail") %>
        <% else %>
          <%= image_tag("https://ws1.sinaimg.cn/large/006tNc79gy1fha84kunf7j305k05kaa2.jpg", :class => "thumbnail") %>
        <% end %>
      <% end %>
    </td>

    <td><%= cart_item.product.price %></td>
    <td>
      <%= form_for cart_item, url: cart_item_path(cart_item.product_id) do |f| %>
        <%= f.select :quantity, 1...cart_item.product.quantity %>
        <%= f.submit "Submit", :disable_with => "Submitting..." %>
      <% end %>
    </td>
    <td><%= link_to("删除商品", cart_item_path(cart_item.product_id), method: :delete, data: { confirm: "你确定要删除该商品吗？" }, :style => "decoration: underline;")%></td>
  </tr>

  <% end %>
</table>



<div class="pull-right cleanfix">
  总计 <%= current_cart.total_price %> RMB
</div>

<br>
<hr>

<div class="pull-right cleanfix">
  <%= link_to("确认结账", order_confirm_cart_path(current_cart), method: :post, :class => "btn btn-danger")%>
</div>
